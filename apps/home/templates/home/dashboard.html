{% extends "layouts/base.html" %} {% load poll_extras %}


{% block title %} <div class="media-body ms-2 text-dark align-items-center d-none d-lg-block">
    <span class="mb-0 font-small fw-bold text-gray-900">
      Bienvenido: <strong>{{ request.user.username }}</strong>
    </span>
  </div>
 {% endblock %}


{% block stylesheets %}{% endblock stylesheets %}


{% block content %}
<div class="row">
    <div class="col-xl-12 col-sm-12 mb-4">
        <div class="card border-0 shadow">
            <div class="card-body">
                <div id="ventasAnuales"></div>
            </div>
        </div>
    </div>
    <div class="col-xl-6 col-sm-12 mb-4">
        <div class="card border-0 shadow">
            <div class="card-body">
                <div id="ventasClasificacion"></div>
                Borrar: <small>Ventas por clasificacion</small>
            </div>
            <div class="card-footer text-center">
                Total de ventas: <strong>$</strong>
            </div>
        </div>
    </div>
    <div class="col-xl-6 col-sm-12 mb-4">
        <div class="card border-0 shadow">
            <div class="card-body">
                <div id="ventasSegmento"></div>
                Borrar: <small>Ventas por segmento</small>
            </div>
            <div class="card-footer text-center">
                Total de ventas: <strong>$</strong>
            </div>
        </div>
    </div>
    <div class="col-xl-6 col-sm-12 mb-4">
        <div class="card border-0 shadow">
            <div class="card-body">
                <div id="comisionesVendedor"></div>
                Borrar: <small>Comisiones por vendedor</small>
            </div>
        </div>
    </div>
    <div class="col-xl-6 col-sm-12 mb-4">
        <div class="card border-0 shadow">
            <div class="card-body">
                <div id="ventasVendedor"></div>
                Borrar: <small>Ventas por vendedor</small>
            </div>
        </div>
    </div>
</div>


{% endblock content %}


{% block javascripts %}
<script>
    // ? Ventas Anuales Grafica de puntos (HighCharts)
    Highcharts.chart('ventasAnuales', {
        chart: {
            type: 'line'
        },
        title: {
            text: 'Ventas por mes del a√±o {% now "Y" %}'
        },
        xAxis: {
            categories: [{% for venta in ventas_anuales %} '{{venta.mes|month_name}}', {% endfor %}]
        },
        yAxis: {
            title: {
                text: 'Total en $MXN'
            }
        },
        plotOptions: {
            line: {
                dataLabels: {
                    enabled: true
                },
                enableMouseTracking: false
            }
        },
        series: [{
            name: '{% now "Y" %}',
            data: [{% for venta in ventas_anuales %} {{venta.total}}, {% endfor %}]
        }]
    });


    // Data retrieved from https://netmarketshare.com
Highcharts.chart('ventasClasificacion', {
  chart: {
    plotBackgroundColor: null,
    plotBorderWidth: null,
    plotShadow: false,
    type: 'pie'
  },
  title: {
    text: 'ventas Clasificacion'
  },
  tooltip: {
    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
  },
  accessibility: {
    point: {
      valueSuffix: '%'
    }
  },
  plotOptions: {
    pie: {
      allowPointSelect: true,
      cursor: 'pointer',
      dataLabels: {
        enabled: true,
        format: '<b>{point.name}</b>: {point.percentage:.1f} %'
      }
    }
  },
  series: [{
    name: 'Academia',
    colorByPoint: true,
    data: [{
      name: 'Tercero',
      y: 70.67,
      sliced: true,
      selected: true
    }, {
      name: 'Segundo',
      y: 14.77
    },  {
      name: 'Gobierno',
      y: 4.86
    }, {
      name: 'Primero',
      y: 2.63
    }, {
     
      name: 'Other',
      y: 2.6
    }]
  }]
});

Highcharts.chart('ventasSegmento', {
  chart: {
    plotBackgroundColor: null,
    plotBorderWidth: null,
    plotShadow: false,
    type: 'pie'
  },
  title: {
    text: 'ventas Segmento'
  },
  tooltip: {
    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
  },
  accessibility: {
    point: {
      valueSuffix: '%'
    }
  },
  plotOptions: {
    pie: {
      allowPointSelect: true,
      cursor: 'pointer',
      dataLabels: {
        enabled: true,
        format: '<b>{point.name}</b>: {point.percentage:.1f} %'
      }
    }
  },
  series: [{
    name: 'Academia',
    colorByPoint: true,
    data: [{
      name: 'Tercero',
      y: 70.67,
      sliced: true,
      selected: true
    }, {
      name: 'Primero',
      y: 2.63
    }, {
     
      name: 'Other',
      y: 2.6
    }]
  }]
});
</script>
{% endblock javascripts %}